.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "YAF 1"
.TH YAF 1 " 3-Mar-2013" "0.9.0" "QoF"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
yaf \- Yet Another Flowmeter
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 10
\&    yaf     [\-\-in INPUT_SPECIFIER] [\-\-out OUTPUT_SPECIFIER]
\&            [\-\-live LIVE_TYPE] [\-\-ipfix TRANSPORT_PROTOCOL]
\&            [\-\-filter BPF_FILTER]
\&            [\-\-rotate ROTATE_DELAY] [\-\-lock] [\-\-caplist]
\&            [\-\-group SPREAD_GROUP_NAME(s)]
\&            [\-\-groupby GROUPBY_TYPE]
\&            [\-\-stats INTERVAL][\-\-no\-stats] [\-\-noerror]
\&            [\-\-dag\-interface]
\&            [\-\-napatech\-interface]
\&            [\-\-gre\-decode] [\-\-no\-frag]
\&            [\-\-max\-frags FRAG_TABLE_MAX]
\&            [\-\-ip4\-only] [\-\-ip6\-only]
\&            [\-\-idle\-timeout IDLE_TIMEOUT]
\&            [\-\-active\-timeout ACTIVE_TIMEOUT]
\&            [\-\-udp\-temp\-timeout TEMPLATE_TIMEOUT]
\&            [\-\-force\-read\-all]
\&            [\-\-flow\-stats] [\-\-delta]
\&            [\-\-ingress INGRESS_INT] [\-\-egress EGRESS_INT]
\&            [\-\-max\-payload PAYLOAD_OCTETS] [\-\-udp\-payload]
\&            [\-\-max\-flows FLOW_TABLE_MAX]
\&            [\-\-export\-payload] [\-\-silk] [\-\-udp\-uniflow PORT]
\&            [\-\-uniflow] [\-\-mac] [\-\-force\-ip6\-export]
\&            [\-\-observation\-domain DOMAIN_ID] [\-\-entropy]
\&            [\-\-applabel] [\-\-applabel\-rules RULES_FILE]
\&            [\-\-ipfix\-port PORT] [\-\-tls] [\-\-tls\-ca CA_PEM_FILE]
\&            [\-\-tls\-cert CERT_PEM_FILE] [\-\-tls\-key KEY_PEM_FILE]
\&            [\-\-become\-user UNPRIVILEGED_USER]
\&            [\-\-become\-group UNPRIVILEGED_GROUP]
\&            [\-\-log LOG_SPECIFIER] [\-\-loglevel LOG_LEVEL]
\&            [\-\-verbose] [\-\-version]
\&            [\-\-p0fprint] [\-\-p0f\-fingerprints FILENAME]
\&            [\-\-fpexport]
\&            [\-\-plugin\-name LIBPLUGIN_NAME[,LIBPLUGIN_NAME...]]
\&            [\-\-plugin\-opts "OPTIONS[,OPTIONS...]"]
\&            [\-\-plugin\-conf CONF_FILE_PATH[,CONF_FILE_PATH...]]
\&            [\-\-pcap PCAP_OUTPUT_DIRECTORY] [\-\-pcap\-per\-flow]
\&            [\-\-max\-pcap MAX_FILE_MB] [\-\-pcap\-timer PCAP_ROTATE_DELAY]
\&            [\-\-pcap\-meta\-file META_FILENAME] [\-\-index\-pcap]
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fByaf\fR is Yet Another Flowmeter and \fByaf\fR is a suite of tools to do flow metering.
\&\fByaf\fR is used as a sensor to capture flow information on a network and export that
information in \s-1IPFIX\s0 format. It reads packet data from \fB\f(BIpcap\fB\|(3)\fR dumpfiles as
generated by \fB\f(BItcpdump\fB\|(1)\fR, from live capture from an interface using \fB\f(BIpcap\fB\|(3)\fR,
an Endace \s-1DAG\s0 capture device, or a Napatech adapter, aggregates these packets
into flows, and exports flow records via \s-1IPFIX\s0 over \s-1SCTP\s0, \s-1TCP\s0 or \s-1UDP\s0, Spread, or into
serialized \s-1IPFIX\s0 message streams (\s-1IPFIX\s0 files) on the local file system.
.PP
Since \fByaf\fR is designed to be deployed on white-box sensors attached to local
network segments or span ports at symmetric routing points, it supports
bidirectional flow assembly natively. Biflow export is done via the export
method specified in \fB\s-1RFC\s0 5103\fR Bidirectional Flow Export using \s-1IPFIX\s0. See the
\&\fB\s-1OUTPUT\s0\fR section below for information on this format.
.PP
\&\fByaf\fR also supports experimental partial payload capture, specifically for
banner-grabbing applications and protocol verification purposes.
.PP
The output of \fByaf\fR is designed to be collected and manipulated by flow
processing toolchains supporting \s-1IPFIX\s0. The \fB\f(BIyafscii\fB\|(1)\fR tool, which is
installed as part of \fByaf\fR, can also be used to print \fByaf\fR output in a
human-readable format somewhat reminiscient of \fB\f(BItcpdump\fB\|(1)\fR. \fByaf\fR output
can also be analyzed using the SiLK suite, and the \fB\f(BInafalize\fB\|(1)\fR tool, both
available from the \s-1CERT\s0 NetSA group.
.SH "OPTIONS"
.IX Header "OPTIONS"
.SS "Input Options"
.IX Subsection "Input Options"
These options control where \fByaf\fR will take its input from. \fByaf\fR can read packets
from a pcap dumpfile (as generated by \fBtcpdump \-w\fR) or live from an interface
via \fIlibpcap\fR, \fIlibdag\fR, or \fIlibpcapexpress\fR (Napatech Adapter library).
By default, if no input options are given, \fByaf\fR reads a pcap dumpfile
on standard input.
.IP "\fB\-\-in\fR \fI\s-1INPUT_SPECIFIER\s0\fR" 4
.IX Item "--in INPUT_SPECIFIER"
\&\fI\s-1INPUT_SPECIFIER\s0\fR is an input specifier. If \fB\-\-live\fR is given, this is the
name of an interface (e.g. \f(CW\*(C`eth0\*(C'\fR, \f(CW\*(C`en0\*(C'\fR, \f(CW\*(C`dag0\*(C'\fR) to capture packets from.
Otherwise, it is a filename; the string \fB\-\fR may be used to read from
standard input (the default).
.IP "\fB\-\-caplist\fR" 4
.IX Item "--caplist"
If present, treat the filename in \fI\s-1INPUT_SPECIFIER\s0\fR as an ordered
newline-delimited list of pathnames to \fB\f(BIpcap\fB\|(3)\fR dumpfiles. Blank lines
and lines beginning with the character '#' within this are ignored. All
pathnames are evaluated with respect to the working directory \fByaf\fR
is run in. These dumpfiles are processed in order using the same flow
table, so they must be listed in ascending time order. This option is
intended to ease the use of yaf with rotated or otherwise split \fB\f(BItcpdump\fB\|(1)\fR
output.
.IP "\fB\-\-noerror\fR" 4
.IX Item "--noerror"
Used with the \fB\-\-caplist\fR option.  When present, this prevents \fByaf\fR from
exiting when processing a list of dumpfiles in the middle due to an error
in a file.  \fByaf\fR will continue to process all files given in the
\&\fI\s-1INPUT_SPECIFIER\s0\fR despite errors within those files.
.IP "\fB\-\-live\fR \fI\s-1LIVE_TYPE\s0\fR" 4
.IX Item "--live LIVE_TYPE"
If present, capture packets from an interface named in the \fI\s-1INPUT_SPECIFIER\s0\fR.
\&\fI\s-1LIVE_TYPE\s0\fR is one of \fBpcap\fR for packet capture via libpcap, or \fBdag\fR for
packet capture via an Endace \s-1DAG\s0 interface using libdag, or \fBnapatech\fR for
packet capture via a Napatech Adapter using libpcapexpress. \fBdag\fR is only
available if \fByaf\fR was built with Endace \s-1DAG\s0 support. \fBnapatech\fR is only
available if \fByaf\fR was built with libpcapexpress, a library maintained by nPulse
Technologies for use with a Napatech adapter.
.IP "\fB\-\-dag\-interface\fR" 4
.IX Item "--dag-interface"
If present, the interface on which a packet was received will be noted internally
within \fByaf\fR.  When flow records are exported from \fByaf\fR, an \f(CW\*(C`ingressinterface\*(C'\fR
and an \f(CW\*(C`egressinterface\*(C'\fR set of fields will be added to the output.  The
\&\f(CW\*(C`ingressinterface\*(C'\fR field will be the physical interface which captured the packet
while the \f(CW\*(C`egressinterface\*(C'\fR will be the physical interface | 0x100.  This can
be used to separate traffic based on \s-1DAG\s0 physical ports.  This option requires
building \fByaf\fR with the \fB\-\-enable\-daginterface\fR switch.
.IP "\fB\-\-napatech\-interface\fR" 4
.IX Item "--napatech-interface"
Similar to \fB\-\-dag\-interface\fR, if present, the interface on which a packet was
received will be noted internally within \fByaf\fR.  When flow records are exported
from \fByaf\fR, an \f(CW\*(C`ingressinterface\*(C'\fR and an \f(CW\*(C`egressinterface\*(C'\fR set of fields will
be added to the output. The \f(CW\*(C`ingressinterface\*(C'\fR field will be the physical interface
which captured the packet while the \f(CW\*(C`egressinterface\*(C'\fR will be the the physical
interface | 0x100.  This can be used to separate traffic based on Napatech physical
ports.  This option requires building \fByaf\fR with the \fB\-\-enable\-napatechinterface\fR
switch.
.IP "\fB\-\-filter\fR \fI\s-1BPF_FILTER\s0\fR" 4
.IX Item "--filter BPF_FILTER"
If present, enable Berkeley Packet Filtering (\s-1BPF\s0) in \fByaf\fR with \fI\s-1FILTER_EXPRESSION\s0\fR as the incoming traffic filter.  Syntax of \fI\s-1FILTER_EXPRESSION\s0\fR follows the expression format described in the \fB\f(BItcpdump\fB\|(1)\fR man page.  This option is not currently supported if \fB\-\-live\fR is set to \fBdag\fR or \fBnapatech\fR as \s-1BPF\s0 filtering is implemented with libpcap.  This option is also not supported on a Bivio due to the Bivio supplied version of libpcap that supports the zero-copy driver.
.SS "Output Options"
.IX Subsection "Output Options"
These options control where \fByaf\fR will send its output. \fByaf\fR can write flows
to an \s-1IPFIX\s0 file or export flows to an \s-1IPFIX\s0 collector over \s-1SCTP\s0, \s-1TCP\s0, \s-1UDP\s0, or Spread.
By default, if no output options are given, \fByaf\fR writes an \s-1IPFIX\s0 file to
standard output.
.IP "\fB\-\-out\fR \fI\s-1OUTPUT_SPECIFIER\s0\fR" 4
.IX Item "--out OUTPUT_SPECIFIER"
\&\fI\s-1OUTPUT_SPECIFIER\s0\fR is an output specifier. If \fB\-\-ipfix\fR is present,
the \fI\s-1OUTPUT_SPECIFIER\s0\fR specifies the hostname or \s-1IP\s0 address of the
collector to which the flows will be exported. Otherwise, if \fB\-\-rotate\fR
is present, \fI\s-1OUTPUT_SPECIFIER\s0\fR is the prefix name of each output file
to write to. If \fB\-\-ipfix\fR is present and set to \fBspread\fR, then \fI\s-1OUTPUT_SPECIFIER\s0\fR should be set to the name of the Spread daemon to connect to (See below examples of spread daemon names).  Otherwise, \fI\s-1OUTPUT_SPECIFIER\s0\fR is a filename in which the flows will be written; the string \fB\-\fR may be used to write to standard output (the default).
.IP "Examples" 4
.IX Item "Examples"
.RS 4
.PD 0
.IP "Output to file" 1
.IX Item "Output to file"
.PD
\&\f(CW\*(C`\-\-out flows.yaf\*(C'\fR
.IP "Output to collector on port 18000 at \s-1IP\s0 address 1.2.3.4" 1
.IX Item "Output to collector on port 18000 at IP address 1.2.3.4"
\&\f(CW\*(C`\-\-out 1.2.3.4 \-\-ipfix\-port 18000 \-\-ipfix tcp\*(C'\fR
.ie n .IP "Connect to the Spread daemon named ""4803"" on the local machine" 1
.el .IP "Connect to the Spread daemon named ``4803'' on the local machine" 1
.IX Item "Connect to the Spread daemon named 4803 on the local machine"
\&\f(CW\*(C`\-\-out 4803 or \-\-out 4803@localhost\*(C'\fR
.ie n .IP "Connect to the machine identified by the domain name ""host.domain.edu"" on port 4803." 1
.el .IP "Connect to the machine identified by the domain name ``host.domain.edu'' on port 4803." 1
.IX Item "Connect to the machine identified by the domain name host.domain.edu on port 4803."
\&\f(CW\*(C`\-\-out 4803@host.domain.edu\*(C'\fR
.ie n .IP "Connect to the machine identified by the \s-1IP\s0 address ""x.y.123.45"" on port 18000." 1
.el .IP "Connect to the machine identified by the \s-1IP\s0 address ``x.y.123.45'' on port 18000." 1
.IX Item "Connect to the machine identified by the IP address x.y.123.45 on port 18000."
\&\f(CW\*(C`\-\-out x.y.123.45 \-\-ipfix\-port 18000\*(C'\fR
.RE
.RS 4
.RE
.IP "\fB\-\-ipfix\fR \fI\s-1TRANSPORT_PROTOCOL\s0\fR" 4
.IX Item "--ipfix TRANSPORT_PROTOCOL"
If present, causes \fByaf\fR to operate as an \s-1IPFIX\s0 exporter, sending
\&\s-1IPFIX\s0 Messages via the specified transport protocol to the collector (e.g.,
SiLK's rwflowpack or flowcap facilities) named in the \fI\s-1OUTPUT_SPECIFIER\s0\fR.
Valid \fI\s-1TRANSPORT_PROTOCOL\s0\fR values are \fBtcp\fR, \fBudp\fR, \fBsctp\fR, and \fBspread\fR;
\&\fBsctp\fR is only available if \fByaf\fR was built with \s-1SCTP\s0 support; \fBspread\fR is only available if \fByaf\fR was built with Spread support. \s-1UDP\s0 is not recommended, as it is not a reliable transport protocol, and cannot guarantee delivery of messages.  As per the recommendations in \s-1RFC\s0 5101, \fByaf\fR will retransmit templates three times within the template timeout period (configurable using \fB\-\-udp\-temp\-timeout\fR or by default, 10 minutes).  Use the
\&\fB\-\-ipfix\-port\fR, \fB\-\-tls\fR, \fB\-\-tls\-ca\fR, \fB\-\-tls\-cert\fR, \fB\-\-tls\-key\fR, \fB\-\-tls\-pass\fR, and \fB\-\-group\fR options to further configure the connection to the
\&\s-1IPFIX\s0 collector.
.IP "\fB\-\-rotate\fR \fI\s-1ROTATE_DELAY\s0\fR" 4
.IX Item "--rotate ROTATE_DELAY"
If present, causes \fByaf\fR to write output to multiple files, opening a new output
file every \fI\s-1ROTATE_DELAY\s0\fR seconds in the input data. Rotated files are named
using the prefix given in the \fI\s-1OUTPUT_SPECIFIER\s0\fR, followed by a suffix
containing a timestamp in \f(CW\*(C`YYYYMMDDhhmmss\*(C'\fR format, a decimal serial number,
and the file extension \fB.yaf\fR.
.IP "\fB\-\-lock\fR" 4
.IX Item "--lock"
Use lockfiles for concurrent file access protection on output files.
This is recommended for interoperating with the Airframe filedaemon
facility.
.IP "\fB\-\-stats\fR \fI\s-1INTERVAL\s0\fR" 4
.IX Item "--stats INTERVAL"
If present, causes \fByaf\fR to export process statistics every \fI\s-1INTERVAL\s0\fR seconds.
The default value for \fI\s-1INTERVAL\s0\fR is 300 seconds or every 5 minutes. \fByaf\fR uses \s-1IPFIX\s0 Options Templates and Records
to export flow, fragment, and decoding statistics.  If \fI\s-1INTERVAL\s0\fR is set
to zero, stats will not be exported.
.IP "\fB\-\-no\-stats\fR" 4
.IX Item "--no-stats"
If present, \fByaf\fR will not export process statistics.  \fByaf\fR uses \s-1IPFIX\s0
Options Templates and Records to export flow, fragment, and decoding
statistics.  \fB\-\-no\-stats\fR takes precedence over \fB\-\-stats\fR.
.SS "Decoder Options"
.IX Subsection "Decoder Options"
These options are used to modify the \fByaf\fR packet decoder's behavior. None of
these options are required; the default behavior for each option when not
present is noted.
.IP "\fB\-\-no\-frag\fR" 4
.IX Item "--no-frag"
If present, ignore all fragmented packets. By default, \fByaf\fR will reassemble
fragments with a 30 second fragment timeout.
.IP "\fB\-\-max\-frags\fR \fI\s-1FRAG_TABLE_MAX\s0\fR" 4
.IX Item "--max-frags FRAG_TABLE_MAX"
If present, limit the number of outstanding, not-yet reassembled fragments
in the fragment table to \fI\s-1FRAG_TABLE_MAX\s0\fR by prematurely expiring fragments
from the table. This option is provided to limit \fByaf\fR resource usage when
operating on data from very large networks or networks with abnormal
fragmentation. The fragment table may exceed this limit slightly due
to limits on how often \fByaf\fR prunes the fragment table (every 5 seconds).
By default, there is no fragment table limit, and the fragment
table can grow to resource exhaustion.
.IP "\fB\-\-ip4\-only\fR" 4
.IX Item "--ip4-only"
If present, ignore all IPv6 packets and export IPv4 flows only.  The default is
to process both IPv4 and IPv6 packets.
.IP "\fB\-\-ip6\-only\fR" 4
.IX Item "--ip6-only"
If present, ignore all IPv4 packets and export IPv6 flows only.  The default is
to process both IPv4 and IPv6 packets.
.IP "\fB\-\-gre\-decode\fR" 4
.IX Item "--gre-decode"
If present, attempt to decode \s-1GRE\s0 version 0 encapsulated packets. Flows will
be created from packets within the \s-1GRE\s0 tunnels. Undecodeable \s-1GRE\s0 packets will
be dropped. Without this option, \s-1GRE\s0 traffic is exported as \s-1IP\s0 protocol 47
flows. This option is presently experimental.
.SS "Flow Table Options"
.IX Subsection "Flow Table Options"
These options are used to modify the flow table behavior within \fByaf\fR. None of
these options are required; the default behavior for each option when not
present is noted.
.IP "\fB\-\-idle\-timeout\fR \fI\s-1IDLE_TIMEOUT\s0\fR" 4
.IX Item "--idle-timeout IDLE_TIMEOUT"
Set flow idle timeout in seconds. Flows are considered idle and flushed
from the flow table if no packets are received for \fI\s-1IDLE_TIMEOUT\s0\fR seconds.
The default flow idle timeout is 300 seconds (5 minutes).
.IP "\fB\-\-active\-timeout\fR \fI\s-1ACTIVE_TIMEOUT\s0\fR" 4
.IX Item "--active-timeout ACTIVE_TIMEOUT"
Set flow active timeout in seconds. Any flow lasting longer than
\&\fI\s-1ACTIVE_TIMEOUT\s0\fR seconds will be flushed from the flow table.
The default flow active timeout is 1800 seconds (30 minutes).
.IP "\fB\-\-udp\-temp\-timeout\fR \fI\s-1TEMPLATE_TIMEOUT\s0\fR" 4
.IX Item "--udp-temp-timeout TEMPLATE_TIMEOUT"
Set \s-1UDP\s0 template timeout in seconds if \fB\-\-ipfix\fR is set to \fIudp\fR.  As per \s-1RFC\s0 5101 recommendations, \fByaf\fR
will attempt to export templates three times within \fI\s-1TEMPLATE_TIMEOUT\s0\fR.  The
default template timeout period is 600 seconds (10 minutes).
.IP "\fB\-\-max\-payload\fR \fI\s-1PAYLOAD_OCTETS\s0\fR" 4
.IX Item "--max-payload PAYLOAD_OCTETS"
If present, capture at most \fI\s-1PAYLOAD_OCTETS\s0\fR octets from the start of
each direction of each flow. Non-TCP flows will only capture payload
from the first packet unless \fB\-\-udp\-payload\fR is set. If not present, \fByaf\fR will not attempt to capture
payload. Payload capture must be enabled for payload export
(\fB\-\-export\-payload\fR), application labeling (\fB\-\-applabel\fR), and entropy
evaluation (\fB\-\-entropy\fR). Note that payload capture is still an
experimental feature.
.IP "\fB\-\-max\-flows\fR \fI\s-1FLOW_TABLE_MAX\s0\fR" 4
.IX Item "--max-flows FLOW_TABLE_MAX"
If present, limit the number of open flows in the flow table to
\&\fI\s-1FLOW_TABLE_MAX\s0\fR by prematurely expiring the flows with the least
recently received packets; this is analogous to an adaptive idle
timeout. This option is provided to limit \fByaf\fR resource usage when
operating on data from large networks. By default, there is no flow
table limit, and the flow table can grow to resource exhaustion.
.IP "\fB\-\-udp\-payload\fR" 4
.IX Item "--udp-payload"
If present, capture at most \fI\s-1PAYLOAD_OCTETS\s0\fR octets fom the start of each direction of each \s-1UDP\s0 flow, where \fI\s-1PAYLOAD_OCTETS\s0\fR is set using the \fB\-\-max\-payload\fR flag.
.IP "\fB\-\-silk\fR" 4
.IX Item "--silk"
If present, export flows in \*(L"SiLK mode\*(R". As of \fByaf\fR 2.0, this will export
\&\s-1TCP\s0 information (flags, \s-1ISN\s0) in the main flow record instead of within the
SubTemplateMultiList.  This flag must be used when exporting to SiLK for it to
collect \s-1TCP\s0 flow information.  This also introduces the following incompatibilities
with standard \s-1IPFIX\s0 export:
.RS 4
.IP "\(bu" 4
totalOctetCount and reverseTotalOctetCount are clamped to 32 bits. Any packet
that would cause either of these counters to overflow 32 bits will cause the
flow to close with flowEndReason 0x02 (active timeout), and will become the
first packet of a new flow. This is analogous to forcing an active timeout
when the octet counters overflow.
.IP "\(bu" 4
The high-order bit of the flowEndReason \s-1IE\s0 is set on any flow created on a
counter overflow, as above.
.IP "\(bu" 4
The high-order bit of the flowEndReason \s-1IE\s0 is set on any flow created on an
active timeout.
.RE
.RS 4
.Sp
Since this changes the semantics of the exported flowEndReason \s-1IE\s0, it should
only be used when generating flows and exporting to rwflowpack, flowcap, or
writing files for processing with rwipfix2silk.
.RE
.IP "\fB\-\-force\-read\-all\fR" 4
.IX Item "--force-read-all"
If present, \fByaf\fR will process out-of-sequence packets.  However, it will
still reject out-of-sequence fragments.
.SS "Export Options"
.IX Subsection "Export Options"
These options are used to modify the the data exported by \fByaf\fR.
.IP "\fB\-\-export\-payload\fR" 4
.IX Item "--export-payload"
If present, export at most \fI\s-1PAYLOAD_OCTETS\s0\fR (the argument to
\&\fB\-\-max\-payload\fR) octets from the start of each direction of each
flow. Non-TCP flows will only export payload from the first packet. By default,
\&\fByaf\fR will not export flow payload.
.IP "\fB\-\-uniflow\fR" 4
.IX Item "--uniflow"
If present, export biflows using the Record Adjacency method in
section 3 of \s-1RFC\s0 5103. This is useful when exporting to \s-1IPFIX\s0
Collecting Processes that are not biflow-aware.
.IP "\fB\-\-mac\fR" 4
.IX Item "--mac"
If present, export MAC-layer information; presently, exports source and destination \s-1MAC\s0 addresses.
.IP "\fB\-\-force\-ip6\-export\fR" 4
.IX Item "--force-ip6-export"
If present, force IPv4 flows to be exported with IPv6\-mapped IPv4 addresses in
::FFFF/96. This will cause all flows to appear to be IPv6 flows.
.IP "\fB\-\-observation\-domain\fR \fI\s-1DOMAIN_ID\s0\fR" 4
.IX Item "--observation-domain DOMAIN_ID"
Set the observationDomainID on each exported \s-1IPFIX\s0 message to the given
integer value. If not present, the observationDomainId defaults to 0.  This
value is also used as the exportingProcessId in the \fByaf\fR statistics Option
Record as a Scope Field.
.IP "\fB\-\-udp\-uniflow\fR \fI\s-1PORT\s0\fR" 4
.IX Item "--udp-uniflow PORT"
If present, export each \s-1UDP\s0 packet on the given port (or 1 for all ports) as a single flow, with flowEndReason set to \s-1YAF_END_UDPFORCE\s0 (0x1F).  This will not close the flow. The flow will stay open until it closes naturally by the idle and active timeouts.  Most useful with \fB\-\-export\-payload\fR in order to export every \s-1UDP\s0 payload on a specific port.
.IP "\fB\-\-flow\-stats\fR" 4
.IX Item "--flow-stats"
If present, export extra flow attributes and statistics in the
subTemplateMultiList field.  This will maintain information such as small
packet count, large packet count, nonempty packet count, average
interarrival times, total data octets, and max packet size.  See the flow
statistics template below for more information about each of the fields \fByaf\fR
exports.
.IP "\fB\-\-delta\fR" 4
.IX Item "--delta"
If present, export octet and packet total counts in the delta count information
elements.  octetTotalCount will be exported in octetDeltaCount (\s-1IE\s0 1), 
reverseOctetTotalCount will be exported in reverseOctetDeltaCount.  packetTotalCount
will be exported in packetDeltaCount (\s-1IE\s0 2), and reversePacketTotalCount will be
exported in reversePacketDeltaCount.
.IP "\fB\-\-ingress\fR \fI\s-1INGRESS_INT\s0\fR" 4
.IX Item "--ingress INGRESS_INT"
If present, set the ingressInterface field in the flow template to \fI\s-1INGRESS_INT\s0\fR.  
This field will also be populated if \fByaf\fR was configured with \-\-enable\-daginterface or
\&\-\-enable\-napatechinterface or \-\-with\-bivio.  If yaf is running on a dag, napatech, or 
bivio, and the physical interface is available, this value will override \fI\s-1INGRESS_INT\s0\fR.
.IP "\fB\-\-egress\fR \fI\s-1EGRESS_INT\s0\fR" 4
.IX Item "--egress EGRESS_INT"
If present, set the egressInterface field in the flow template to \fI\s-1EGRESS_INT\s0\fR.
This field will also be populated if \fByaf\fR was configured with \-\-enable\-daginterface
or \-\-enable\-napatechinterface or \-\-with\-bivio. If yaf is running on a dag, napatech, or
bivio, and the physical interface is available, this value will override \fI\s-1EGRESS_INT\s0\fR.
.SS "Application Labeler Options"
.IX Subsection "Application Labeler Options"
If \fByaf\fR is built with application labeler support enabled (using the
\&\fB\-\-enable\-applabel\fR option to \fB./configure\fR when \fByaf\fR is built), then
\&\fByaf\fR can examine packet payloads and determine the application protocol
in use within a flow, and export a 16\-bit application label with
each flow.
.PP
The exported application label uses the common port number for the
protocol.  For example, \s-1HTTP\s0 traffic, independent of what port the
traffic is detected on, will be labeled with a value of 80, the
default \s-1HTTP\s0 port.  Labels and rules are taken from a configuration
file read at \fByaf\fR startup time.
.PP
Application labeling requires payload capture to be enabled with the
\&\fB\-\-max\-payload\fR option. A minimum payload capture length of 384
octets is recommended for best results.
.PP
Application labeling is presently experimental. SiLK does support
\&\s-1IPFIX\s0 import and translation of the application label via
\&\fBrwflowpack\fR, \fBflowcap\fR, and \fBrwipfix2silk\fR.
.IP "\fB\-\-applabel\fR" 4
.IX Item "--applabel"
If present, export application label data. Requires \fB\-\-max\-payload\fR
to enable payload capture.
.IP "\fB\-\-applabel\-rules\fR \fI\s-1RULES_FILE\s0\fR" 4
.IX Item "--applabel-rules RULES_FILE"
Read application labeler rules from \fI\s-1RULES_FILE\s0\fR. If not present,
rules are read by default from \fI/Users/brian/opt/etc/yafApplabelRules.conf\fR.
.SS "Entropy Measurement"
.IX Subsection "Entropy Measurement"
If \fByaf\fR is built with entropy measurement enabled (using the
\&\fB\-\-enable\-entropy\fR option to \fB./configure\fR when \fByaf\fR is built,)
then \fByaf\fR can examine the packet payloads and determine a Shannon
Entropy value for the payload.  The entropy calculation does not
include the network (\s-1IP\s0) or transport (\s-1UDP/TCP\s0) headers.  The entropy
is calculated in terms of bits per byte, (log base 2.)  The
calculation generates a real number value between 0.0 and 8.0.  That
number is then converted into an 8\-bit integer value between 0 and
255.  Roughly, numbers above 230 are generally compressed (or encrypted)
and numbers centered around approximately 140 are English text.  Lower
numbers carry even less information content.  Another useful piece of
information is that \s-1SSL/TLS\s0 tends to zero pad its packets, which causes
the entropy of those flows to drop quite low.
.IP "\fB\-\-entropy\fR" 4
.IX Item "--entropy"
If present, export the entropy values for both the forward and reverse
payloads.  Requires the \fB\-\-max\-payload\fR option to operate.
.SS "\s-1IPFIX\s0 Connection Options"
.IX Subsection "IPFIX Connection Options"
These options are used to configure the connection to an \s-1IPFIX\s0 collector.
.IP "\fB\-\-ipfix\-port\fR \fI\s-1PORT\s0\fR" 4
.IX Item "--ipfix-port PORT"
If \fB\-\-ipfix\fR is present, export flows to \s-1TCP\s0, \s-1UDP\s0, or \s-1SCTP\s0 port \fI\s-1PORT\s0\fR.
If not present, the default \s-1IPFIX\s0 port 4739 is used. If \fB\-\-tls\fR is also
present, the default secure \s-1IPFIX\s0 port 4740 is used.
.IP "\fB\-\-tls\fR" 4
.IX Item "--tls"
If \fB\-\-ipfix\fR is present, use \s-1TLS\s0 to secure the connection to the
\&\s-1IPFIX\s0 collector. Requires the \fI\s-1TRANSPORT_PROTOCOL\s0\fR to be \fBtcp\fR, as \s-1DTLS\s0 over
\&\s-1UDP\s0 or \s-1SCTP\s0 is not yet supported. Requires the \fB\-\-tls\-ca\fR, \fB\-\-tls\-cert\fR, and
\&\fB\-\-tls\-key\fR options to specify the X.509 certificate and \s-1TLS\s0 key information.
.IP "\fB\-\-tls\-ca\fR \fI\s-1CA_PEM_FILE\s0\fR" 4
.IX Item "--tls-ca CA_PEM_FILE"
Use the Certificate Authority or Authorities in \fI\s-1CA_PEM_FILE\s0\fR to verify the
remote \s-1IPFIX\s0 Collecting Process' X.509 certificate. The connection to the
Collecting Process will fail if its certificate was not signed by this \s-1CA\s0
(or by a certificate signed by this \s-1CA\s0, recursively); this prevents export to
unauthorized Collecting Processes. Required if \fB\-\-tls\fR is present.
.IP "\fB\-\-tls\-cert\fR \fI\s-1CERT_PEM_FILE\s0\fR" 4
.IX Item "--tls-cert CERT_PEM_FILE"
Use the X.509 certificate in \fI\s-1CERT_PEM_FILE\s0\fR to identify this \s-1IPFIX\s0 Exporting
Process. This certificate should contain the public part of the private key in
\&\fI\s-1KEY_PEM_FILE\s0\fR. Required if \fB\-\-tls\fR is present.
.IP "\fB\-\-tls\-key\fR \fI\s-1KEY_PEM_FILE\s0\fR" 4
.IX Item "--tls-key KEY_PEM_FILE"
Use the private key in \fI\s-1KEY_PEM_FILE\s0\fR for this \s-1IPFIX\s0 Exporting Process. This
key should contain the private part of the public key in
\&\fI\s-1CERT_PEM_FILE\s0\fR. Required if \fB\-\-tls\fR is present. If the key is encrypted,
the password must be present in the \s-1YAF_TLS_PASS\s0 environment variable.
.IP "\fB\-\-group\fR \fI\s-1SPREAD_GROUP_NAME\s0\fR" 4
.IX Item "--group SPREAD_GROUP_NAME"
If \fB\-\-ipfix\fR is present and set to \fBspread\fR, use \fB\-\-group\fR to specify the spread group name(s) to publish output.
It is possible to list more than one group name in a comma-seperated list.
To use Spread as a manifold for different types of flows, use the format
\&\fI\s-1GROUP\s0, \s-1GROUP_NAME:VALUE\s0, \s-1GROUP_NAME:VALUE\s0\fR as the argument to \fB\-\-group\fR
and use the \fB\-\-groupby\fR switch.  This list should be contained in quotes if it contains spaces (\fByaf\fR will ignore spaces in quotes). It is suggested to use one group
as the catchall for all flows (no value listed) so flows are not lost.
The \fB\-\-groupby\fR switch must be used if \fB\-\-group\fR uses \s-1GROUP:VALUE\s0
format. See the Spread Documentation, www.spread.org,
for more details on Spread.
.IP "\fB\-\-groupby\fR \fI\s-1GROUPBY_TYPE\s0\fR" 4
.IX Item "--groupby GROUPBY_TYPE"
If \fB\-\-group\fR is used with group values, use \fB\-\-groupby\fR to specify what
type of value should be used.  Options are \fIport, vlan, applabel, protocol, version\fR.
\&\fB\-\-groupby\fR accepts only one argument.   The \fIport\fR option is destination
transport port of the flow.  \fIversion\fR is the \s-1IP\s0 version of the flow.
.SS "Privilege Options"
.IX Subsection "Privilege Options"
These options are used to cause \fByaf\fR to drop privileges when running as root
for live capture purposes.
.IP "\fB\-\-become\-user\fR \fI\s-1UNPRIVILEGED_USER\s0\fR" 4
.IX Item "--become-user UNPRIVILEGED_USER"
After opening the live capture device in \fB\-\-live\fR mode, drop
privilege to the named user. Using \fB\-\-become\-user\fR requires \fByaf\fR to
be run  as root or setuid root. This option will cause all files
written by \fByaf\fR to be owned by the user \fI\s-1UNPRIVILEGED_USER\s0\fR and the
user's primary group; use \fB\-\-become\-group\fR as well to change the group
\&\fByaf\fR runs as for output purposes.
.Sp
If running as root for live capture purposes and \fB\-\-become\-user\fR is not
present, \fByaf\fR will warn that privilege is not being dropped. We highly
recommend the use of this option, especially in production environments,
for security purposes.
.IP "\fB\-\-become\-group\fR \fI\s-1UNPRIVILEGED_GROUP\s0\fR" 4
.IX Item "--become-group UNPRIVILEGED_GROUP"
\&\fB\-\-become\-group\fR can be used to change the group from the default of
the user given in \fB\-\-become\-user\fR.  This option has no effect if
given without the \fB\-\-become\-user\fR option as well.
.SS "\s-1PCAP\s0 Options"
.IX Subsection "PCAP Options"
These options are used to turn on and configure \fByaf\fR's \s-1PCAP\s0 export
capability.
.IP "\fB\-\-pcap\fR \fI\s-1PCAP_OUTPUT_DIRECTORY\s0\fR" 4
.IX Item "--pcap PCAP_OUTPUT_DIRECTORY"
This option turns on \s-1PCAP\s0 export in \fByaf\fR.  It will capture and write
packets for all network traffic \fByaf\fR has received and processed to
\&\s-1PCAP\s0 files in the given \fI\s-1OUTPUT_DIRECTORY\s0\fR.  \fI\s-1OUTPUT_DIRECTORY\s0\fR must be
a valid directory. Pcap files will have names in the form of
\&\*(L"yaf_[datetime]_serialno.pcap\*(R".  \fByaf\fR will write to a file until the
file size has reached \fB\-\-max\-pcap\fR or every \fB\-\-pcap\-timer\fR seconds
(whichever happens first). By default, \fByaf\fR rotates files every 5 \s-1MB\s0. Files
will be \*(L"locked\*(R" (\*(L".lock\*(R" will be appended to the filename) until \fByaf\fR has
closed the file. Be aware that your Operating System will have a limit on the
maximum number of files in a directory and a maximum file size.  If this
limit is reached, \fByaf\fR will write warning messages and terminate \s-1PCAP\s0 export.
This may effect flow generation if \fByaf\fR is also writing \s-1IPFIX\s0 files.
Optionally, you can also export meta information about the flows in each
rolling \s-1PCAP\s0 file with the \fB\-\-pcap\-meta\-file\fR switch.
.IP "\fB\-\-pcap\-per\-flow\fR" 4
.IX Item "--pcap-per-flow"
If present, \fByaf\fR will write a pcap file for each flow in the output
directory given to \fB\-\-pcap\fR.  This option is experimental and should only be
used when reading pcap files of reasonable size.  \fByaf\fR only writes up to
\&\fB\-\-max\-payload\fR bytes of each packet to the pcap file.  Therefore,
\&\fB\-\-max\-payload\fR must be set to an appropriate size to prevent packets from
being truncated in the pcap file.  \fByaf\fR will use the
last three digits of the flowStartMilliseconds as the directory and the
flow key hash, flowStartMilliseconds, and serial number as the filename.
See the included
getFlowKeyHash program to easily calculate the name of the file for a given
flow.  When the pcap file has reached \fB\-\-max\-pcap\fR size, \fByaf\fR will close
the file, increment the serial number, and open a new pcap file with the same
naming convention. Note that your operating system has a limit to the number
of open file handles \fByaf\fR can maintain at any given time.  Therefore, the
performance of \fByaf\fR degrades when the number of open flows is greater than
the maximum number of file handles.
.IP "\fB\-\-max\-pcap\fR \fI\s-1MAX_FILE_MB\s0\fR" 4
.IX Item "--max-pcap MAX_FILE_MB"
If present, set the maximum file size of pcap files to \fI\s-1MAX_FILE_MB\s0\fR \s-1MB\s0.
The default is 5 \s-1MB\s0.
.IP "\fB\-\-pcap\-timer\fR \fI\s-1PCAP_ROTATE_DELAY\s0\fR" 4
.IX Item "--pcap-timer PCAP_ROTATE_DELAY"
If present, \fByaf\fR will rotate rolling pcap files every \fI\s-1PCAP_ROTATE_DELAY\s0\fR
seconds or when the file reaches \fB\-\-max\-pcap\fR size, whichever happens first.
By default, \fByaf\fR only rotates files based on file size.
.IP "\fB\-\-pcap\-meta\-file\fR \fI\s-1META_FILENAME\s0\fR" 4
.IX Item "--pcap-meta-file META_FILENAME"
If present and \-\-pcap is also present, \fByaf\fR will export metadata 
on the flows contained in
each rolling pcap file \fByaf\fR is writing to the filename specified by \fI\s-1META_FILENAME\s0\fR.  \fByaf\fR
will write a line in the form:
.RS 4
.IP "\fIflow_key_hash | flowStartMilliseconds | pcap_file_name\fR" 1
.IX Item "flow_key_hash | flowStartMilliseconds | pcap_file_name"
.RE
.RS 4
.Sp
for each flow in the pcap.  If a flow exists across 3 pcap
files, there will be 3 lines in \fI\s-1META_FILENAME\s0\fR for that flow (each line
having a different filename).  The pcap-meta-file will rotate files every 10
rolling pcap files.  A new file will be created in the form \fI\s-1META_FILENAME\s0\fRx
where x starts at 1 and increments by 1 for every new pcap-meta-file created.
This file can be uploaded to a database for flow correlation and flow-to-pcap
analysis.
.Sp
If \fB\-\-pcap\-meta\-file\fR is present and \-\-pcap is not present, 
\&\fByaf\fR will export information about the
pcap file(s) it is presently reading, as opposed to the pcap files \fByaf\fR is writing.
For each packet in the pcap file, \fByaf\fR will write a line in the form:
.IP "\fIflow_key_hash | flowStartMilliseconds | file_num | offset | length\fR" 1
.IX Item "flow_key_hash | flowStartMilliseconds | file_num | offset | length"
.RE
.RS 4
.Sp
\&\f(CW\*(C`file_num\*(C'\fR is the sequential file number that \fByaf\fR has processed.  If \fByaf\fR
was given a single pcap file, this number will always be 0.
\&\f(CW\*(C`offset\*(C'\fR is the offset into the pcap file of the beginning of the packet,
at the start of the pcap packet header. \f(CW\*(C`length\*(C'\fR is the length of the packet including
the pcap packet header. 
Using this offset, a separate program would be able to quickly extract packets
for a flow. This file only rotates if \fI\s-1META_FILE\s0\fR reaches max size.
.RE
.IP "\fB\-\-index\-pcap\fR" 4
.IX Item "--index-pcap"
If present and \fB\-\-pcap\fR and \fB\-\-pcap\-meta\-file\fR are also present, 
export offset and length information about the packets \fByaf\fR is 
writing to the rolling pcap files.  Adding this option will force
\&\fByaf\fR to write one line per packet to the \fBpcap-meta-file\fR in the form:
.RS 4
.IP "\fIflow_key_hash | flowStartMilliseconds | pcap_file_name | offset | length\fR" 1
.IX Item "flow_key_hash | flowStartMilliseconds | pcap_file_name | offset | length"
.RE
.RS 4
.RE
.SS "Logging Options"
.IX Subsection "Logging Options"
These options are used to specify how log messages are routed. \fByaf\fR can
log to standard error, regular files, or the \s-1UNIX\s0 syslog facility.
.IP "\fB\-\-log\fR \fI\s-1LOG_SPECIFIER\s0\fR" 4
.IX Item "--log LOG_SPECIFIER"
Specifies destination for log messages. \fI\s-1LOG_SPECIFIER\s0\fR can be a \fIsyslog\fR\|(3)
facility name, the special value \fBstderr\fR for standard error, or the
\&\fIabsolute\fR path to a file for file logging. The default log
specifier is \fBstderr\fR if available, \fBuser\fR otherwise.
.IP "\fB\-\-loglevel\fR \fI\s-1LOG_LEVEL\s0\fR" 4
.IX Item "--loglevel LOG_LEVEL"
Specify minimum level for logged messages. In increasing levels of verbosity,
the supported log levels are \fBquiet\fR, \fBerror\fR, \fBcritical\fR, \fBwarning\fR,
\&\fBmessage\fR, \fBinfo\fR, and \fBdebug\fR. The default logging level is \fBwarning\fR.
.IP "\fB\-\-verbose\fR" 4
.IX Item "--verbose"
Equivalent to \fB\-\-loglevel debug\fR.
.IP "\fB\-\-version\fR" 4
.IX Item "--version"
If present, print version and copyright information to standard error and exit.
.SS "Plugin Options"
.IX Subsection "Plugin Options"
These options are used to load, configure, and run a \fByaf\fR plugin.
.IP "\fB\-\-plugin\-name\fR \fILIBPLUGIN_NAME[,LIBPLUGIN_NAME...]\fR" 4
.IX Item "--plugin-name LIBPLUGIN_NAME[,LIBPLUGIN_NAME...]"
Specify the plugin to load.  The loaded plugin must follow the \fByaf\fR plugin framework.  \fI\s-1LIBPLUGIN_NAME\s0\fR must be the full path to the plugin library name.  Two plugins are included with c<yaf>, a Deep Packet Inspection plugin, and a
\&\s-1DHCP\s0 Fingerprinting plugin. This flag will only be recognized if \fByaf\fR is configured with \fB\-\-enable\-plugins\fR. There are also configure options to export only \s-1DNS\s0 Authoritative and NXDomain responses. Read each plugin's documentation
for more information.
.ie n .IP "\fB\-\-plugin\-opts\fR \fI""OPTIONS[,OPTIONS...]""\fR" 4
.el .IP "\fB\-\-plugin\-opts\fR \fI``OPTIONS[,OPTIONS...]''\fR" 4
.IX Item "--plugin-opts OPTIONS[,OPTIONS...]"
Specify the arguments to the plugin given to \fB\-\-plugin\-name\fR.  This flag will only be recognized if \fByaf\fR is configured with \fB\-\-enable\-plugins\fR and \fB\-\-plugin\-name\fR is set to a valid plugin.  For example, the \s-1DPI\s0 Plugin takes the well-known port of a protocol(s) to enable \s-1DPI\s0 (default for \s-1DPI\s0 is all protocols).
.IP "\fB\-\-plugin\-conf\fR \fICONF_FILE_PATH[,CONF_FILE_PATH...]\fR" 4
.IX Item "--plugin-conf CONF_FILE_PATH[,CONF_FILE_PATH...]"
Specify the path to a configuration file for the plugin given to \fB\-\-plugin\-name\fR.  This flag will only be recognized if
\&\fByaf\fR is configured with \fB\-\-enable\-plugins\fR and \fB\-\-plugin\-name\fR is set to a valid plugin.  If this switch is not used,
but the plugin requires a configuration file, the default location \fI/Users/brian/opt/etc\fR will be used.
.SS "Passive \s-1OS\s0 Fingerprinting (p0f)"
.IX Subsection "Passive OS Fingerprinting (p0f)"
These options are used to enable p0f in \fByaf\fR. p0f is presently experimental.  There is no support in \fByafscii\fR or SiLK for printing p0f related data.  Currently, \fByaf\fR uses the p0f Version 2 \s-1SYN\s0 fingerprints (see p0f.fp).
.IP "\fB\-\-p0fprint\fR" 4
.IX Item "--p0fprint"
If present, export p0f data.  This data consists of three related information elements; osName, osVersion, osFingerPrint.  This flag requires \fByaf\fR to be configured with \fB\-\-enable\-p0fprinter\fR.
.IP "\fB\-\-p0f\-fingerprints\fR" 4
.IX Item "--p0f-fingerprints"
Location of the p0f fingerprint file(s), p0f.fp.  Default is \fI/Users/brian/opt/etc/p0f.fp\fR.  This version of 
\&\fByaf\fR includes the updated \s-1CERT\s0 p0f fingerprints.  See <https://tools.netsa.cert.org/confluence/display/tt/p0f+fingerprints> for updates.
.IP "\fB\-\-fpexport\fR" 4
.IX Item "--fpexport"
If present, enable export of handshake headers for external \s-1OS\s0 fingerprinters.  The related information elements are firstPacketBanner and secondPacketBanner.  This flag requires \fByaf\fR to be configured with \fB\-\-enable\-fpexporter\fR.
.SH "OUTPUT"
.IX Xref "OUTPUT"
.IX Header "OUTPUT"
.SS "Basic Flow Record"
.IX Subsection "Basic Flow Record"
\&\fByaf\fR's output consists of an \s-1IPFIX\s0 message stream. \fByaf\fR uses a variety of
templates for \s-1IPFIX\s0 data records; the information elements that may appear
in these templates are enumerated below. For further information about the \s-1IPFIX\s0
information model and \s-1IPFIX\s0 message stream, see \fB\s-1RFC\s0 5102\fR, \fB\s-1RFC\s0 5101\fR, and
\&\fB\s-1RFC\s0 5103\fR.  As of \fByaf\fR 2.0, \fByaf\fR nests some templates in an \s-1IPFIX\s0
subTemplateMultiList.  In order to retain compatibility with the SiLK Tools,
use \fB\-\-silk\fR to prevent \fByaf\fR from nesting \s-1TCP\s0 Information Elements.  Below
are descriptions of each of the templates \fByaf\fR will export.  See the
Internet-Draft \fBExport of Structured Data in \s-1IPFIX\s0\fR for more information on \s-1IPFIX\s0 lists.
.PP
\&\fByaf\fR assigns information element numbers to reverse flow elements in biflow
capture based on the standard \s-1IPFIX\s0 \s-1PEN\s0 29305.  This applies only for
information elements defined in the standard \s-1IPFIX\s0 Information Model
(\fB\s-1RFC\s0 5102\fR) that do not have a reverse information element already defined.
For information elements defined under the \s-1CERT\s0 \s-1PEN\s0, a standard method is
used to calculate their reverse element identifier.  The method is that
bit fourteen is set to one in the \s-1IE\s0 field, (e.g. 16384 + the forward \s-1IE\s0 number.)
.IP "\fBflowStartMilliseconds\fR \s-1IE\s0 152, 8 octets, unsigned" 4
.IX Item "flowStartMilliseconds IE 152, 8 octets, unsigned"
Flow start time in milliseconds since 1970\-01\-01 00:00:00 \s-1UTC\s0. Always present.
.IP "\fBflowEndMilliseconds\fR \s-1IE\s0 153, 8 octets, unsigned" 4
.IX Item "flowEndMilliseconds IE 153, 8 octets, unsigned"
Flow end time in milliseconds since 1970\-01\-01 00:00:00 \s-1UTC\s0. Always present.
.IP "\fBoctetTotalCount\fR \s-1IE\s0 85, 8 octets, unsigned" 4
.IX Item "octetTotalCount IE 85, 8 octets, unsigned"
Number of octets in packets in forward direction of flow. Always present.
May be encoded in 4 octets using \s-1IPFIX\s0 reduced-length encoding.
.IP "\fBreverseOctetTotalCount\fR Reverse (\s-1PEN\s0 29305) \s-1IE\s0 85, 8 octets, unsigned" 4
.IX Item "reverseOctetTotalCount Reverse (PEN 29305) IE 85, 8 octets, unsigned"
Number of octets in packets in reverse direction of flow. Present if flow
has a reverse direction. May be encoded in 4 octets using \s-1IPFIX\s0
reduced-length encoding.
.IP "\fBpacketTotalCount\fR \s-1IE\s0 86, 8 octets, unsigned" 4
.IX Item "packetTotalCount IE 86, 8 octets, unsigned"
Number of packets in forward direction of flow. Always present.
May be encoded in 4 octets using \s-1IPFIX\s0 reduced-length encoding.
.IP "\fBreversePacketTotalCount\fR Reverse (\s-1PEN\s0 29305) \s-1IE\s0 86, 8 octets, unsigned" 4
.IX Item "reversePacketTotalCount Reverse (PEN 29305) IE 86, 8 octets, unsigned"
Number of packets in reverse direction of flow. Present if flow has a
reverse direction. May be encoded in 4 octets using \s-1IPFIX\s0 reduced-length
encoding.
.IP "\fBreverseFlowDeltaMilliseconds\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 21, 4 octets, unsigned" 4
.IX Item "reverseFlowDeltaMilliseconds CERT (PEN 6871) IE 21, 4 octets, unsigned"
Difference in time in milliseconds between first packet in forward direction
and first packet in reverse direction. Correlates with (but does not
necessarily represent) round-trip time. Present if flow has a reverse
direction.
.IP "\fBsourceIPv4Address\fR \s-1IE\s0 8, 4 octets, unisigned" 4
.IX Item "sourceIPv4Address IE 8, 4 octets, unisigned"
IPv4 address of flow source or biflow initiator. Present for IPv4
flows without IPv6\-mapped addresses only.
.IP "\fBdestinationIPv4Address\fR \s-1IE\s0 12, 4 octets, unsigned" 4
.IX Item "destinationIPv4Address IE 12, 4 octets, unsigned"
IPv4 address of flow source or biflow responder. Present for IPv4
flows without IPv6\-mapped addresses only.
.IP "\fBsourceIPv6Address\fR \s-1IE\s0 27, 16 octets, unsigned" 4
.IX Item "sourceIPv6Address IE 27, 16 octets, unsigned"
IPv6 address of flow source or biflow initiator. Present for IPv6
flows or IPv6\-mapped IPv4 flows only.
.IP "\fBdestinationIPv6Address\fR \s-1IE\s0 28, 16 octets, unsigned" 4
.IX Item "destinationIPv6Address IE 28, 16 octets, unsigned"
IPv6 address of flow source or biflow responder. Present for IPv6
flows or IPv6\-mapped IPv4 flows only.
.IP "\fBsourceTransportPort\fR \s-1IE\s0 7, 2 octets, unsigned" 4
.IX Item "sourceTransportPort IE 7, 2 octets, unsigned"
\&\s-1TCP\s0 or \s-1UDP\s0 port on the flow source or biflow initiator endpoint.
Always present.
.IP "\fBdestinationTransportPort\fR \s-1IE\s0 11, 2 octets, usigned" 4
.IX Item "destinationTransportPort IE 11, 2 octets, usigned"
\&\s-1TCP\s0 or \s-1UDP\s0 port on the flow destination or biflow responder endpoint.
Always present. For \s-1ICMP\s0 flows, contains \s-1ICMP\s0 type * 256 + \s-1ICMP\s0 code.
This is non-standard, and an open issue in \fByaf\fR.
.IP "\fBflowAttributes\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 40, 2 octets, unsigned" 4
.IX Item "flowAttributes CERT (PEN 6871) IE 40, 2 octets, unsigned"
Miscellaneous flow attributes for the forward direction of the flow.
Always present (\fByaf\fR 2.1 or later).  Current flag values:
.RS 4
.IP "Bit 1: All packets in the forward direction have fixed size" 2
.IX Item "Bit 1: All packets in the forward direction have fixed size"
.PD 0
.IP "Bit 2: Packet(s) in the forward direction was received out-of-sequence" 2
.IX Item "Bit 2: Packet(s) in the forward direction was received out-of-sequence"
.RE
.RS 4
.RE
.IP "\fBreverseFlowAttributes\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16424, 2 octets, unsigned" 4
.IX Item "reverseFlowAttributes CERT (PEN 6871) IE 16424, 2 octets, unsigned"
.PD
Miscellaneous flow attributes for the reverse direction of the flow.
Always present (\fByaf\fR 2.1 or later).  Current flag values:
.RS 4
.IP "Bit 1: All packets in the reverse direction have fixed size" 2
.IX Item "Bit 1: All packets in the reverse direction have fixed size"
.PD 0
.IP "Bit 2: Packet(s) in the reverse direction was received out-of-sequence" 2
.IX Item "Bit 2: Packet(s) in the reverse direction was received out-of-sequence"
.RE
.RS 4
.RE
.IP "\fBprotocolIdentifier\fR \s-1IE\s0 4, 1 octet, unsigned" 4
.IX Item "protocolIdentifier IE 4, 1 octet, unsigned"
.PD
\&\s-1IP\s0 protocol of the flow. Always present.
.IP "\fBflowEndReason\fR \s-1IE\s0 136, 1 octet, unsigned" 4
.IX Item "flowEndReason IE 136, 1 octet, unsigned"
Flow end reason code, as defined by the \s-1IPFIX\s0 Information Model.
Always present. In \fB\-\-silk\fR mode, the high-order bit is set if the flow
was created by continuation.
.IP "\fBsilkAppLabel\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 33, 2 octets, unsigned" 4
.IX Item "silkAppLabel CERT (PEN 6871) IE 33, 2 octets, unsigned"
Application label, defined as the primary well-known port associated
with a given application. Present if the application labeler is
enabled, and was able to determine the application protocol used
within the flow.
.IP "\fBvlanId\fR \s-1IE\s0 58, 2 octets, unsigned" 4
.IX Item "vlanId IE 58, 2 octets, unsigned"
802.1q \s-1VLAN\s0 tag of the first packet in the forward direction of the flow.
.IP "\fBreverseVlanId\fR Reverse (\s-1PEN\s0 29305) \s-1IE\s0 58, 2 octets, unsigned" 4
.IX Item "reverseVlanId Reverse (PEN 29305) IE 58, 2 octets, unsigned"
802.1q \s-1VLAN\s0 tag of the first packet in the reverse direction of the flow.
Present if the flow has a reverse direction.
.IP "\fBingressInterface\fR \s-1IE\s0 10, 4 octets, unsigned" 4
.IX Item "ingressInterface IE 10, 4 octets, unsigned"
The index of the \s-1IP\s0 interface where packets of this flow are being received.
Use \-\-ingress, \-\-napatech\-interface, \-\-dag\-interface or configure \fByaf\fR with
bivio for this field to be present in the flow template.  Use \-\-ingress to
manually set this field.
.IP "\fBegressInterface\fR \s-1IE\s0 14, 4 octets, unsigned" 4
.IX Item "egressInterface IE 14, 4 octets, unsigned"
The index of the \s-1IP\s0 interface where packets of this flow are being received.
Use \-\-egress, \-\-napatech\-interface, \-\-dag\-interface or configure \fByaf\fR with
bivio for this field to be present in the flow template. If using napatech, dag,
or bivio, \f(CW\*(C`egressinterface\*(C'\fR will be the physical interface | 0x100.  Use \-\-egress
to manually set this field.
.IP "\fBsubTemplateMultiList\fR \s-1IE\s0 293, variable length" 4
.IX Item "subTemplateMultiList IE 293, variable length"
Represents a list of zero or more instances of a structured data type, where
the data type of each list element can be different and corresponds with
different template definitions.  The Information Element Number will change
upon updates to the \s-1IPFIX\s0 lists specification and libfixbuf releases.
.SS "\s-1TCP\s0 Flow Template"
.IX Subsection "TCP Flow Template"
The following six Information Elements will be exported as a template
within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.IP "\fBtcpSequenceNumber\fR \s-1IE\s0 184, 4 octets, unsigned" 4
.IX Item "tcpSequenceNumber IE 184, 4 octets, unsigned"
Initial sequence number of the forward direction of the flow. Present if
the flow's protocolIdentifier is 6 (\s-1TCP\s0).  This element is contained in the
\&\fByaf\fR \s-1TCP\s0 template within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.IP "\fBreverseTcpSequenceNumber\fR Reverse (\s-1PEN\s0 29305) \s-1IE\s0 184, 4 octets, unsigned" 4
.IX Item "reverseTcpSequenceNumber Reverse (PEN 29305) IE 184, 4 octets, unsigned"
Initial sequence number of the reverse direction of the flow. Present if the
flow's protocolIdentifier is 6 (\s-1TCP\s0) and the flow has a reverse direction.
This element is contained in the \fByaf\fR \s-1TCP\s0 template within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.IP "\fBinitialTCPFlags\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 14, 1 octet, unsigned" 4
.IX Item "initialTCPFlags CERT (PEN 6871) IE 14, 1 octet, unsigned"
\&\s-1TCP\s0 flags of initial packet in the forward direction of the flow.
Present if the flow's protocolIdentifier is 6 (\s-1TCP\s0). This element is contained
in the \fByaf\fR \s-1TCP\s0 template within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.IP "\fBunionTCPFlags\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 15, 1 octet, unsigned" 4
.IX Item "unionTCPFlags CERT (PEN 6871) IE 15, 1 octet, unsigned"
Union of \s-1TCP\s0 flags of all packets other than the initial packet
in the forward direction of the flow. Present if the flow's
protocolIdentifier is 6 (\s-1TCP\s0). This element is contained in the
\&\fByaf\fR \s-1TCP\s0 template within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.IP "\fBreverseInitialTCPFlags\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16398, 1 octet, unsigned" 4
.IX Item "reverseInitialTCPFlags CERT (PEN 6871) IE 16398, 1 octet, unsigned"
\&\s-1TCP\s0 flags of initial packet in the reverse direction of the flow.
Present if the flow's protocolIdentifier is 6 (\s-1TCP\s0) and the flow
has a reverse direction. This element is contained in the
\&\fByaf\fR \s-1TCP\s0 template within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.IP "\fBreverseUnionTCPFlags\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16399, 1 octet, unsigned" 4
.IX Item "reverseUnionTCPFlags CERT (PEN 6871) IE 16399, 1 octet, unsigned"
Union of \s-1TCP\s0 flags of all packets other than the initial packet
in the reverse direction of the flow. Present if the flow's
protocolIdentifier is 6 (\s-1TCP\s0) and the flow has a reverse direction.
This element is contained in the \fByaf\fR \s-1TCP\s0 template within the subTemplateMultiList unless \fB\-\-silk\fR is used.
.SS "\s-1MAC\s0 Flow Template"
.IX Subsection "MAC Flow Template"
The following two Information Elements will be exported as a template
within the subTemplateMultiList.
.IP "\fBsourceMacAddress\fR, \s-1IE\s0 56, 6 octets, unsigned" 4
.IX Item "sourceMacAddress, IE 56, 6 octets, unsigned"
Source \s-1MAC\s0 Address of the first packet in the forward direction of the flow.
This element is contained in the \fByaf\fR \s-1MAC\s0 template within the subTemplateMultiList.
.IP "\fBdestinationMacAddress\fR, \s-1IE\s0 80, 6 octets, unsigned" 4
.IX Item "destinationMacAddress, IE 80, 6 octets, unsigned"
Destination \s-1MAC\s0 Address of the first packet in the reverse direction of the flow. This element is contained in the \fByaf\fR \s-1MAC\s0 template within the subTemplateMultiList.
.SS "Payload Flow Template"
.IX Subsection "Payload Flow Template"
The following two Information Elements will be exported as a template
within the subTemplateMultiList.
.IP "\fBpayload\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 18, variable-length" 4
.IX Item "payload CERT (PEN 6871) IE 18, variable-length"
Initial \fIn\fR bytes of forward direction of flow payload.
Present if payload collection is enabled and payload is present
in the forward direction of the flow. This element is contained in the
\&\fByaf\fR Payload template within the subTemplateMultiList.
.IP "\fBreversePayload\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16402, variable-length" 4
.IX Item "reversePayload CERT (PEN 6871) IE 16402, variable-length"
Initial \fIn\fR bytes of reverse direction of flow payload.
Present if payload collection is enabled and payload is present
in the reverse direction of the flow. This element is contained in the \fByaf\fR
Payload template within the subTemplateMultiList.
.SS "Entropy Flow Template"
.IX Subsection "Entropy Flow Template"
The following two Information Elements will be exported as a template
within the subTemplateMultiList.
.IP "\fBpayloadEntropy\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 35, 1 octet, unsigned" 4
.IX Item "payloadEntropy CERT (PEN 6871) IE 35, 1 octet, unsigned"
Shannon Entropy calculation of the forward payload data. This element is
contained in the \fByaf\fR Entropy template within the subTemplateMultiList.
.IP "\fBreversePayloadEntropy\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16419, 1 octet, unsigned" 4
.IX Item "reversePayloadEntropy CERT (PEN 6871) IE 16419, 1 octet, unsigned"
Shannon Entropy calculation of the reverse payload data.  This element is
contained in the \fByaf\fR Entropy template within the subTemplateMultiList.
.SS "p0f Flow Template"
.IX Subsection "p0f Flow Template"
The following six Information Elements will be exported as a template
within the subTemplateMultiList if present and only if p0f is enabled.
.IP "\fBosName\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 36, variable-length" 4
.IX Item "osName CERT (PEN 6871) IE 36, variable-length"
p0f \s-1OS\s0 Name for the forward flow based on the \s-1SYN\s0 packet and p0f \s-1SYN\s0 Fingerprints.  Present only if p0f is enabled.  This element is contained in the \fByaf\fR
p0f template within the subTemplateMultiList.
.IP "\fBreverseOsName\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16420, variable-length" 4
.IX Item "reverseOsName CERT (PEN 6871) IE 16420, variable-length"
p0f \s-1OS\s0 Name for the reverse flow based on the \s-1SYN\s0 packet and p0f \s-1SYN\s0 Fingerprints.  Present only if p0f is enabled. This element is contained in the \fByaf\fR
p0f template within the subTemplateMultiList.
.IP "\fBosVersion\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 37, variable-length" 4
.IX Item "osVersion CERT (PEN 6871) IE 37, variable-length"
p0f \s-1OS\s0 Version for the forward flow based on the \s-1SYN\s0 packet and p0f \s-1SYN\s0 Fingerprints.  Present only if p0f is enabled. This element is contained in the
\&\fByaf\fR p0f template within the subTemplateMultiList.
.IP "\fBreverseOsVersion\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16421, variable-length" 4
.IX Item "reverseOsVersion CERT (PEN 6871) IE 16421, variable-length"
p0f \s-1OS\s0 Version for the reverse flow based on the \s-1SYN\s0 packet and p0f \s-1SYN\s0 fingerprints.  Present only if p0f is enabled. This element is contained in the
\&\fByaf\fR p0f template within the subTemplateMultiList.
.IP "\fBosFingerPrint\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 107, variable-length" 4
.IX Item "osFingerPrint CERT (PEN 6871) IE 107, variable-length"
p0f \s-1OS\s0 Fingerprint for the forward flow based on the \s-1SYN\s0 packet and p0f \s-1SYN\s0 fingerprints.  Present only if p0f is enabled. This element is contained in the \fByaf\fR p0f template within the subTemplateMultiList.
.IP "\fBreverseOsFingerPrint\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16491, variable-length" 4
.IX Item "reverseOsFingerPrint CERT (PEN 6871) IE 16491, variable-length"
p0f \s-1OS\s0 Fingerprint for the reverse flow based on the \s-1SYN\s0 packet and p0f \s-1SYN\s0 Fingerprints. Present only if p0f is enabled. This element is contained in the \fByaf\fR p0f template within the subTemplateMultiList.
.SS "Fingerprint Exporting Template"
.IX Subsection "Fingerprint Exporting Template"
The following four Information Elements will be exported as a template
within the subTemplateMultiList if present and only if fpexport is enabled.
.IP "\fBfirstPacketBanner\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 38, variable-length" 4
.IX Item "firstPacketBanner CERT (PEN 6871) IE 38, variable-length"
\&\s-1IP\s0 and transport headers for first packet in forward direction to be used for external \s-1OS\s0 Fingerprinters.  Present only if fpexport is enabled. This element is contained in the \fByaf\fR FPExport template within the subTemplateMultiList.
.IP "\fBreverseFirstPacketBanner\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16422, variable-length" 4
.IX Item "reverseFirstPacketBanner CERT (PEN 6871) IE 16422, variable-length"
\&\s-1IP\s0 and transport headers for first packet in reverse direction to be used for external \s-1OS\s0 Fingerprinters.  Present only if fpexport is enabled. This element is contained in the \fByaf\fR FPExport template within the subTemplateMultiList.
.IP "\fBsecondPacketBanner\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 39, variable-length" 4
.IX Item "secondPacketBanner CERT (PEN 6871) IE 39, variable-length"
\&\s-1IP\s0 and transport headers for second packet in forward direction (third packet in sequence) to be used for external \s-1OS\s0 Fingerprinters.  Present only if fpexport is enabled. This element is contained in the \fByaf\fR FPExport template within the subTemplateMultiList.
.IP "\fBreverseSecondPacketBanner\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16423, variable-length" 4
.IX Item "reverseSecondPacketBanner CERT (PEN 6871) IE 16423, variable-length"
\&\s-1IP\s0 and transport headers for second packet in reverse direction (currently not used).  Present only if fpexport is enabled. This element is contained in the \fByaf\fR FPExport template within the subTemplateMultiList.
.SS "Hooks Templates"
.IX Subsection "Hooks Templates"
\&\fByaf\fR can export other templates within the subTemplateMultiList
if plugins are enabled in \fByaf\fR.  See \fB\f(BIyafdpi\fB\|(1)\fR for descriptions
of the \fByaf\fR Deep Packet Inspection Information Elements.  See \fB\f(BIyafdhcp\fB\|(1)\fR
for descriptions of the \s-1DHCP\s0 Fingerprint Information Elements.
.SS "Flow Statistics Template"
.IX Subsection "Flow Statistics Template"
\&\fByaf\fR can maintain and export more information about each flow than what
is exported in the Basic Flow Template.  If \fByaf\fR is run with \fB\-\-flow\-stats\fR
\&\fByaf\fR will export the following attributes with every flow as long as one
of the following characteristics is nonzero. The following flow attributes
have been known to help in traffic classification.
.IP "\fBdataByteCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 502, 8 octets, unsigned" 4
.IX Item "dataByteCount CERT (PEN 6871) IE 502, 8 octets, unsigned"
Total bytes transferred as payload.
.IP "\fBaverageInterarrivalTime\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 503, 8 octets, unsigned" 4
.IX Item "averageInterarrivalTime CERT (PEN 6871) IE 503, 8 octets, unsigned"
Average number of milliseconds between packets.
.IP "\fBstandardDeviationInterarrivalTime\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 504, 8 octets, unsigned" 4
.IX Item "standardDeviationInterarrivalTime CERT (PEN 6871) IE 504, 8 octets, unsigned"
Standard deviation of the interarrival time for up to the first ten packets.
.IP "\fBtcpUrgTotalCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 509, 4 octets, unsigned" 4
.IX Item "tcpUrgTotalCount CERT (PEN 6871) IE 509, 4 octets, unsigned"
The number of \s-1TCP\s0 packets that have the \s-1URGENT\s0 Flag set.
.IP "\fBsmallPacketCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 500, 4 octets, unsigned" 4
.IX Item "smallPacketCount CERT (PEN 6871) IE 500, 4 octets, unsigned"
The number of packets that contain less than 60 bytes of payload.
.IP "\fBnonEmptyPacketCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 501, 4 octets, unsigned" 4
.IX Item "nonEmptyPacketCount CERT (PEN 6871) IE 501, 4 octets, unsigned"
The number of packets that contain at least 1 byte of payload.
.IP "\fBlargePacketCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 510, 4 octets, unsigned" 4
.IX Item "largePacketCount CERT (PEN 6871) IE 510, 4 octets, unsigned"
The number of packets that contain at least 220 bytes of payload.
.IP "\fBfirstNonEmptyPacketSize\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 505, 2 octets, unsigned" 4
.IX Item "firstNonEmptyPacketSize CERT (PEN 6871) IE 505, 2 octets, unsigned"
Payload length of the first non-empty packet.
.IP "\fBmaxPacketSize\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 506, 2 octets, unsigned" 4
.IX Item "maxPacketSize CERT (PEN 6871) IE 506, 2 octets, unsigned"
The largest payload length transferred in the flow.
.IP "\fBstandardDeviationPayloadLength\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 508, 2 octets, unsigned" 4
.IX Item "standardDeviationPayloadLength CERT (PEN 6871) IE 508, 2 octets, unsigned"
The standard deviation of the payload length for up to the first 10 non empty
packets.
.IP "\fBfirstEightNonEmptyPacketDirections\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 507, 1 octet, unsigned" 4
.IX Item "firstEightNonEmptyPacketDirections CERT (PEN 6871) IE 507, 1 octet, unsigned"
Represents directionality for the first 8 non-empty packets. 0 for forward
direction, 1 for reverse direction.
.IP "\fBreverseDataByteCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16886, 8 octets, unsigned" 4
.IX Item "reverseDataByteCount CERT (PEN 6871) IE 16886, 8 octets, unsigned"
Total bytes transferred as payload in the reverse direction.
.IP "\fBreverseAverageInterarrivalTime\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16887, 8 octets, unsigned" 4
.IX Item "reverseAverageInterarrivalTime CERT (PEN 6871) IE 16887, 8 octets, unsigned"
Average number of milliseconds between packets in reverse direction.
.IP "\fBreverseStandardDeviationInterarrivalTime\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16888, 8 octets, unsigned" 4
.IX Item "reverseStandardDeviationInterarrivalTime CERT (PEN 6871) IE 16888, 8 octets, unsigned"
Standard deviation of the interarrival time for up to the first ten packets
in the reverse direction.
.IP "\fBreverseTcpUrgTotalCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16896, 4 octets, unsigned" 4
.IX Item "reverseTcpUrgTotalCount CERT (PEN 6871) IE 16896, 4 octets, unsigned"
The number of \s-1TCP\s0 packets that have the \s-1URGENT\s0 Flag set in the reverse
direction.
.IP "\fBreverseSmallPacketCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16884, 4 octets, unsigned" 4
.IX Item "reverseSmallPacketCount CERT (PEN 6871) IE 16884, 4 octets, unsigned"
The number of packets that contain less than 60 bytes of payload in reverse
direciton.
.IP "\fBreverseNonEmptyPacketCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16885, 4 octets, unsigned" 4
.IX Item "reverseNonEmptyPacketCount CERT (PEN 6871) IE 16885, 4 octets, unsigned"
The number of packets that contain at least 1 byte of payload in reverse
direction.
.IP "\fBreverseLargePacketCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16894, 4 octets, unsigned" 4
.IX Item "reverseLargePacketCount CERT (PEN 6871) IE 16894, 4 octets, unsigned"
The number of packets that contain at least 220 bytes of payload in the
reverse direction.
.IP "\fBreverseFirstNonEmptyPacketSize\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16889, 2 octets, unsigned" 4
.IX Item "reverseFirstNonEmptyPacketSize CERT (PEN 6871) IE 16889, 2 octets, unsigned"
Payload length of the first non-empty packet in the reverse direction.
.IP "\fBreverseMaxPacketSize\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16890, 2 octets, unsigned" 4
.IX Item "reverseMaxPacketSize CERT (PEN 6871) IE 16890, 2 octets, unsigned"
The largest payload length transferred in the flow in the reverse direction.
.IP "\fBreverseStandardDeviationPayloadLength\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 16892, 2 octets, unsigned" 4
.IX Item "reverseStandardDeviationPayloadLength CERT (PEN 6871) IE 16892, 2 octets, unsigned"
The standard deviation of the payload length for up to the first 10 non empty
packets in the reverse direction.
.SS "Statistics Option Template"
.IX Subsection "Statistics Option Template"
\&\fByaf\fR will export information about its process periodically
using \s-1IPFIX\s0 Options Template Record.  This record gives information
about the status of the flow and fragment table, as well as decoding
information.  This can be turned off using the \fB\-\-no\-stats\fR option.
The following Information Elements will be exported:
.IP "\fBsystemInitTimeMilliseconds\fR \s-1IE\s0 161, 8 octets, unsigned" 4
.IX Item "systemInitTimeMilliseconds IE 161, 8 octets, unsigned"
The time in milliseconds of the last (re\-)initialization of \fByaf\fR.
.IP "\fBexportedFlowRecordTotalCount\fR \s-1IE\s0 42, 8 octets, unsigned" 4
.IX Item "exportedFlowRecordTotalCount IE 42, 8 octets, unsigned"
Total amount of exported flows from \fByaf\fR start time.
.IP "\fBpacketTotalCount\fR \s-1IE\s0 86, 8 octets, unsigned" 4
.IX Item "packetTotalCount IE 86, 8 octets, unsigned"
Total amount of packets processed by \fByaf\fR from \fByaf\fR start time.
.IP "\fBdroppedPacketTotalCount\fR \s-1IE\s0 135, 8 octets, unsigned" 4
.IX Item "droppedPacketTotalCount IE 135, 8 octets, unsigned"
Total amount of dropped packets according to statistics given
by libpcap, libdag, or libpcapexpress.
.IP "\fBignoredPacketTotalCount\fR \s-1IE\s0 164, 8 octets, unsigned" 4
.IX Item "ignoredPacketTotalCount IE 164, 8 octets, unsigned"
Total amount of packets ignored by the \fByaf\fR packet decoder, such as
unsupported packet types and incomplete headers, from \fByaf\fR
start time.
.IP "\fBnotSentPacketTotalCount\fR \s-1IE\s0 167, 8 octets, unsigned" 4
.IX Item "notSentPacketTotalCount IE 167, 8 octets, unsigned"
Total amount of packets rejected by \fByaf\fR because they were received
out of sequence.
.IP "\fBexpiredFragmentCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 100, 4 octets, unsigned" 4
.IX Item "expiredFragmentCount CERT (PEN 6871) IE 100, 4 octets, unsigned"
Total amount of fragments that have been expired since \fByaf\fR
start time.
.IP "\fBassembledFragmentCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 101, 4 octets, unsigned" 4
.IX Item "assembledFragmentCount CERT (PEN 6871) IE 101, 4 octets, unsigned"
Total number of packets that been assembled from a series of
fragments since \fByaf\fR start time.
.IP "\fBflowTableFlushEventCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 104, 4 octets, unsigned" 4
.IX Item "flowTableFlushEventCount CERT (PEN 6871) IE 104, 4 octets, unsigned"
Total number of times the \fByaf\fR flow table has been flushed
since \fByaf\fR start time.
.IP "\fBflowTablePeakCount\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 105, 4 octets, unsigned" 4
.IX Item "flowTablePeakCount CERT (PEN 6871) IE 105, 4 octets, unsigned"
The maximum number of flows in the \fByaf\fR flow table at any
one time since \fByaf\fR start time.
.IP "\fBexporterIPv4Address\fR \s-1IE\s0 130, 4 octets, unsigned" 4
.IX Item "exporterIPv4Address IE 130, 4 octets, unsigned"
The IPv4 Address of the \fByaf\fR flow sensor.
.IP "\fBexportingProcessId\fR \s-1IE\s0 144, 4 octets, unsigned" 4
.IX Item "exportingProcessId IE 144, 4 octets, unsigned"
Set the \s-1ID\s0 of the \fByaf\fR flow sensor by giving a value to
\&\fB\-\-observation\-domain\fR.  The default is 0.
.IP "\fBmeanFlowRate\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 102, 4 octets, unsigned" 4
.IX Item "meanFlowRate CERT (PEN 6871) IE 102, 4 octets, unsigned"
The mean flow rate of the \fByaf\fR flow sensor since \fByaf\fR start time,
rounded to the nearest integer.
.IP "\fBmeanPacketRate\fR \s-1CERT\s0 (\s-1PEN\s0 6871) \s-1IE\s0 103, 4 octets, unsigned" 4
.IX Item "meanPacketRate CERT (PEN 6871) IE 103, 4 octets, unsigned"
The mean packet rate of the \fByaf\fR flow sensor since \fByaf\fR start time,
rounded to the nearest integer.
.SH "SIGNALS"
.IX Header "SIGNALS"
\&\fByaf\fR responds to \fB\s-1SIGINT\s0\fR or \fB\s-1SIGTERM\s0\fR by terminating input processing,
flushing any pending flows to the current output, and exiting. If \fB\-\-verbose\fR
is given, \fByaf\fR responds to \fB\s-1SIGUSR1\s0\fR by printing present flow and fragment table
statistics to its log.  All other signals are handled by the C runtimes in
the default manner on the platform on which \fByaf\fR is currently operating.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
To generate flows from an pcap file into an \s-1IPFIX\s0 file:
.PP
\&\f(CW\*(C`yaf \-\-in packets.pcap \-\-out flows.yaf\*(C'\fR
.PP
To capture flows from a pcap interface and export them to files in the
current directory rotated hourly:
.PP
\&\f(CW\*(C`yaf \-\-live pcap \-\-in en1 \-\-out en1_capture \-\-rotate 3600\*(C'\fR
.PP
To capture flows from an Endace \s-1DAG\s0 card and export them via \s-1IPFIX\s0 over \s-1TCP:\s0
.PP
\&\f(CW\*(C`yaf \-\-live dag \-\-in dag0 \-\-ipfix tcp \-\-out my\-collector.example.com\*(C'\fR
.PP
To convert a pcap formatted packet capture and convert that into \s-1IPFIX:\s0
.PP
\&\f(CW\*(C`yaf <packets.pcap >flows.yaf\*(C'\fR
.PP
To publish to spread group \fB\s-1TST_SPRD\s0\fR for a spread daemon running locally on port 4803:
.PP
\&\f(CW\*(C`yaf \-\-live pcap \-\-in eth1 \-\-out 4803@localhost \-\-ipfix spread \-\-group TST_SPRD\*(C'\fR
.PP
To publish to spread groups based on application label for spread daemon running locally on port 4803:
.PP
\&\f(CW\*(C`yaf \-\-live pcap \-\-in eth1 \-\-out 4803@localhost \-\-ipfix spread \-\-group "SPRD_CATCHALL, SPRD_DNS:53, SPRD_HTTP:80, SPRD_SMTP:25" \-\-groupby applabel \-\-applabel \-\-max\-payload=400\*(C'\fR
.PP
To run \fByaf\fR with application labeling enabled and export via \s-1IPFIX\s0 over \s-1TCP:\s0
.PP
\&\f(CW\*(C`yaf \-\-live pcap \-\-in eth1 \-\-out 127.0.0.1 \-\-ipfix tcp \-\-ipfix\-port=18001 \-\-applabel \-\-applabel\-rules=/usr/local/etc/yafApplabelRules.conf \-\-max\-payload=300\*(C'\fR
.PP
To run \fByaf\fR with \s-1BPF\s0 on \s-1UDP\s0 Port 53
.PP
\&\f(CW\*(C`yaf \-\-live pcap \-\-in en1 \-\-out /path/to/dst/ \-\-rotate 120 \-\-filter="udp port 53"\*(C'\fR
.PP
To run \fByaf\fR with Deep Packet Inspection enabled for \s-1HTTP\s0, \s-1IMAP\s0, and \s-1DNS:\s0
.PP
\&\f(CW\*(C`yaf \-\-in packets.pcap \-\-out flows.yaf \-\-applabel \-\-max\-payload=400 \-\-plugin\-name=/usr/local/lib/dpacketplugin.la \-\-plugin\-opts="80 143 53"\*(C'\fR
.PP
To run \fByaf\fR with Deep Packet Inspection and \s-1DHCP\s0 Fingerprinting:
.PP
\&\f(CW\*(C`yaf \-\-in packets.pcap \-\-out flows.yaf \-\-applabel \-\-max\-payload=1000 \-\-plugin\-name=/usr/local/lib/dpacketplugin.la,/usr/local/lib/dhcp_fp_plugin.la\*(C'\fR
.PP
To run \fByaf\fR with pcap generation:
.PP
\&\f(CW\*(C`yaf \-\-in eth0 \-\-live pcap \-\-out localhost \-\-ipfix tcp \-\-ipfix\-port=18001 \-\-pcap /data/pcap \-\-pcap\-meta\-file=/data/pcap_info.txt\*(C'\fR
.SH "KNOWN ISSUES"
.IX Header "KNOWN ISSUES"
\&\s-1YAF\s0 \s-1BPF\s0 Filtering does not operate with the Bivio Zero-Copy Library.
.PP
\&\s-1YAF\s0 \s-1BPF\s0 Filtering is ignored when using \fB\-\-live\fR \fIdag\fR or \fInapatech\fR
because libpcap is not used.
.PP
\&\s-1YAF\s0 \s-1PCAP\s0 Export options are ignored when using \fB\-\-live\fR \fIdag\fR or \fInapatech\fR.
.PP
\&\s-1YAF\s0 2.x requires libfixbuf 1.0.0 or later.
.PP
\&\s-1YAF\s0 2.0 will not interoperate with the SiLK tools unless \fB\-\-silk\fR is used, due
to the \s-1TCP\s0 Information Elements being nested in the subTemplateMultiList.
\&\s-1YAF\s0 2.0 must be used with an \s-1IPFIX\s0 Collecting Process that can handle \s-1IPFIX\s0 lists elements, especially the subTemplateMultiList Information Element in order to retrieve certain flow information.  Older versions of \s-1YAF\s0 can read \s-1YAF\s0 2.0 flow files, but will ignore anything contained in the subTemplateMultiList.
.PP
The plugin infrastructure has been modified in \s-1YAF\s0 2.0 to export templates
in \s-1YAF\s0's subTemplateMultiList element.
.PP
\&\s-1YAF\s0 2.0 will export statistics in an Options Template and Options Data Records
unless the \fB\-\-no\-stats\fR switch is given.  The \s-1IPFIX\s0 Collecting Process should be
able to differentiate between options records and flow records in order to
prevent incorrect transcoding of statistics records into flow records.
.PP
\&\s-1YAF\s0 will not rotate output files if it is not seeing any flow data.  However,
it will continue to write process statistics messages at the configured
interval time to the most recent output file.
.PP
Presently, the \fBdestinationTransportPort\fR information element contains
\&\s-1ICMP\s0 type and code information for \s-1ICMP\s0 or \s-1ICMP6\s0 flows; this is nonstandard
and may not be interoperable with other \s-1IPFIX\s0 implementations.
.PP
Bug reports and feature requests may be sent via email to
<netsa\-help@cert.org>.
.SH "AUTHORS"
.IX Header "AUTHORS"
Brian Trammell, Chris Inacio,
Michael Duggan, Emily Sarneso, Dan Ruef,
and the \s-1CERT\s0 Network Situational Awareness Group Engineering Team,
<http://www.cert.org/netsa>.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fB\f(BIyafscii\fB\|(1)\fR, \fB\f(BItcpdump\fB\|(1)\fR, \fB\f(BIpcap\fB\|(3)\fR, \fB\f(BInafalize\fB\|(1)\fR, Spread Documentation at www.spread.org, libp0f at <https://tools.netsa.cert.org/confluence/display/tt/libp0f>, and the following \s-1IETF\s0
Internet RFCs: Specification of the \s-1IPFIX\s0 Protocol for the Exchange of \s-1IP\s0
Traffic Flow Information \fB\s-1RFC\s0 5101\fR, Information Model for \s-1IP\s0 Flow Information
Export \fB\s-1RFC\s0 5102\fR, Bidirectional Flow Export using \s-1IPFIX\s0 \fB\s-1RFC\s0 5103\fR, Export of
Structured Data in \s-1IPFIX\s0 \fB\s-1RFC\s0 6313\fR
